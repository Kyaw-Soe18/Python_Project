{% load static %}
<html lang="en">

<head>
<style>
html, body {
    height: 100%;
    margin: 0;
}

body {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    background: linear-gradient(-45deg, #ffffff, #dbeafe, #e0f7fa, #f0f4ff);
    background-size: 400% 400%;
    animation: gradientBG 15s ease infinite;
    font-family: 'Poppins', sans-serif;
}

body.login-page {
    background: url("{{ MEDIA_URL }}default/ucsy_bg1.jpg") no-repeat center center fixed;
    background-size: cover;
    animation: none;
}

main {
    flex: 1; /* Makes main content expand to push footer down */
}

@keyframes gradientBG {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}
</style>

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
{% if page_title %}
<title>{{ page_title }} | Attendance Management System</title>
{% else %}
<title>Attendance Management System</title>
{% endif %}
<link rel="icon" href="{{ MEDIA_URL }}/default/ucsy-logo.png">
<link rel="stylesheet" href="{% static 'assets/font-awesome/css/all.min.css' %}">
<link rel="stylesheet" href="{% static 'assets/bootstrap/css/bootstrap.min.css' %}">
<link rel="stylesheet" href="{% static 'assets/select2/dist/css/select2.min.css' %}">
<link rel="stylesheet" href="{% static 'assets/mdb-blogtemplate/css/mdb.min.css' %}" />
<link rel="stylesheet" href="{% static 'assets/DataTables/datatables.min.css' %}" />
<link rel="stylesheet" href="{% static 'assets/default/css/style.css' %}">

<script src="{% static 'assets/font-awesome/js/all.min.js' %}"></script>
<script src="{% static 'assets/default/js/jquery-3.6.0.min.js' %}"></script>
<script src="{% static 'assets/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
<script src="{% static 'assets/DataTables/datatables.min.js' %}"></script>
<script type="text/javascript" src="{% static 'assets/default/js/script.js' %}"></script>
{% block headerContent %} {% endblock headerContent %}
</head>

<body class="{% if request.resolver_match.url_name == 'login' %}login-page{% endif %}">

{% block TopNavigation %} {% include "TopNavigation.html" %} {% endblock TopNavigation %}

<main class="pt-5 pb-0">
    <div class="container mb-0">
        {% if messages %}
        <div class="row">
            <div class="col-12">
                {% for message in messages %}
                <div class="alert alert-{{message.tags}} w-100 rounded-0 mb-2 redirect-msg">
                    <div class="d-flex w-100">
                        <div class="col-auto flex-shrink-1 flex-grow-1">{{ message }}</div>
                        <div class="col-auto text-center">
                            <button class="btn-close btn-sm text-sm" type="button" onclick="$(this).closest('.alert').remove()"></button>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        {% block pageContent %} {% endblock pageContent %}
    </div>
</main>

{% block ScriptBlock %} {% endblock ScriptBlock %}

<!-- Footer -->
<footer class="bg-light text-lg-start">
    <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
        Â© {% now 'Y' %} Copyright Attendance Management System
    </div>
</footer>

<!-- Universal Modal -->
<div class="modal fade" id="uni_modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-md modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Title</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Content loaded via AJAX -->
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-primary" id="modal-save-btn">Save</button>
                <button type="button" class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
            </div>
        </div>
    </div>
</div>

<!-- Confirmation Modal -->
<div class="modal fade" id="confirm_modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <!-- Confirmation message -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-danger" id="confirm">Continue</button>
            </div>
        </div>
    </div>
</div>

<script>
const loader = $('<div>')
loader.attr('id', 'pre-loader')
loader.html('<div class="lds-default"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>')

window.start_loader = function() {
    $('body').removeClass('loading')
    if ($('#pre-loader').length > 0)
        $('#pre-loader').remove();
    $('body').append(loader)
    $('body').addClass('loading')
}
window.end_loader = function() {
    if ($('#pre-loader').length > 0)
        $('#pre-loader').remove();
    $('body').removeClass('loading')
}
window.uni_modal = function($title = '', $url = '', $size = "") {
    start_loader()
    $.ajax({
        url: $url,
        error: err => {
            console.log(err)
            alert("An error occurred")
        },
        success: function(resp) {
            if (resp) {
                $('#uni_modal .modal-title').html($title)
                $('#uni_modal .modal-body').html(resp)
                if ($size != '') {
                    $('#uni_modal .modal-dialog').addClass($size + ' modal-dialog-centered')
                } else {
                    $('#uni_modal .modal-dialog').removeAttr("class").addClass("modal-dialog modal-md modal-dialog-centered")
                }
                $('#uni_modal').modal({
                    backdrop: 'static',
                    keyboard: false,
                    focus: true
                })
                $('#uni_modal').modal('show')
                end_loader()
            }
        }
    })
}

// Save button submits any form inside modal
$(document).on('click', '#modal-save-btn', function() {
    var form = $('#uni_modal').find('form');
    if(form.length){
        form.submit();
    }
});

window._conf = function($msg = '', $func = '', $params = []) {
    $('#confirm_modal #confirm').attr('onclick', $func + "(" + $params.join(',') + ")")
    $('#confirm_modal .modal-body').html($msg)
    $('#confirm_modal').modal('show')
}

$(function() {
    if ($('.redirect-msg').length > 0) {
        setTimeout(() => {
            $('.redirect-msg').hide('slideUp')
            setTimeout(() => {
                $('.redirect-msg').remove()
            }, 500)
        }, 3500)
    }
})
</script>

<script src="{% static 'assets/select2/dist/js/select2.full.js' %}"></script>
</body>
</html>
